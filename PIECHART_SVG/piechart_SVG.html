
<head>
    <title>SVG Pie Chart Test</title>
    <style type="text/css" media="screen">
      svg {width: 100%; height: 100%;}
    </style>
    
</head>
<body>
    <div id="pieWrap" style="width:800px; height:800px;">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">

<!--       <path id="pathTest" d="M100,100 A50,50 0 1,1 0,100 L50,100 Z"style="fill:magenta;"/> -->
<!--       <path id="pathTest" d="M200,100 A100,100 0 0,1 100,200 L100,100 Z"style="stroke:red;fill:blue"> -->
<!--       <path id="pathTest" d="M100,100 A50,50 0 0,1 50,150"style="stroke:red;fill:blue"> -->
    </svg>
  </div>
  <script>
    /* 
     var ele = new PIE(
            document.querySelector("#pieWrap svg path"), {
              startX:value,
              startY:value,
              radius:value,
              nMaxAngle:value,
              nInterval:value,
              strokeStyle:value,
              fillStyle:value
            });
    */

      function PIE(elTarget, htOption) {
       if(!htOption || typeof htOption !== "object") {
         console.error("option type is wrong");
       }

       this.elPath = elTarget;

       for(var name in htOption) {
         this[name] = htOption[name];
       }

       //중심좌표 
       this.centerX = this.startX - this.radius;
       this.centerY = this.startY;

       this.nCount = 0;

       this._createPathElements();

       this._setDataForSet();

      }

      PIE.prototype._createPathElements = function () {

        var xmlns = "http://www.w3.org/2000/svg";
        var _elParent = document.querySelector("#pieWrap > svg");

        this.elPath = document.createElementNS(xmlns, "path");

        var _coords = this._setCoordValue();

        this.elPath.setAttribute("id" , "elPath");
        this.elPath.setAttribute("d" , _coords);
        this.elPath.setAttribute("style" , "stroke:"+this.strokeStyle+";fill:"+this.fillStyle);
        _elParent.appendChild(this.elPath);
      };


      PIE.prototype._setCoordValue = function() {

        var _result = "M" + this.startX + " " + this.startY + " "+ 
                      "A" + this.radius + "," + this.radius + " "+ 
                      "0 0,1 "+
                      this.startX + ","+
                      this.startY + " "+
                      "L" + this.centerX + "," + this.centerY + " "+
                      "Z";
        return _result;
      };

      PIE.prototype._setDataForSet = function() {

       /*
       var segments = el.pathSegList;
       // Move : x,y ------> segments.getItem(0);
       // ARC : r1, r2, angle, largeArcFlag, sweepFlag, x, y ----->  segments.getItem(1);
       // LINE : x,y  ------> segments.getItem(2);
       */
        var _segments = this.elPath.pathSegList;
        this._arc = _segments.getItem(1);
      };

      PIE.prototype.runAnimation = function() {
          //약속된 크기까지만 동작한다. 
          if(this.nCount >= this.nMaxAngle) return;

          //interval 만큼 증가
          this.nCount = this.nCount + this.nInterval;

          //각도를 기준으로 x,y좌표값을 설정
          this._arc.x = (this.startX - this.radius) + (+(Math.cos(Math.PI/180 * this.nCount))) * this.radius;
          this._arc.y = (this.startY) + (+(Math.sin(Math.PI/180 * this.nCount))) * this.radius;

          //180도가 넘으면 largeArcFlag를 변경해야 한다.
          if(this.nCount >= 180) this._arc.largeArcFlag = 1;
          this.timeCtl = setTimeout(this.runAnimation.bind(this), 16);
      };

      PIE.prototype._resetAnimation = function() {
        this.nCount = 0;
        this._arc.largeArcFlag = 0;
        clearTimeout(this.timeCtl);
      };

      PIE.prototype.reStartAnimation = function() {
        this._resetAnimation();
        this.runAnimation();
      };

      /* START Service CODE */



    </script>
</body>